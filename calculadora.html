<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Calculadora de Frete com PIX</title>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
<style>
  body { font-family: 'Roboto', sans-serif; background:url('https://images.unsplash.com/photo-1590487980957-c1d58f9edce3?auto=format&fit=crop&w=1350&q=80') no-repeat center center fixed; background-size: cover; margin:0; padding:0; display:flex; justify-content:center; align-items:center; min-height:100vh; }
  .container { background-color: rgba(255,255,255,0.95); border-radius:15px; padding:30px; max-width:500px; width:90%; box-shadow:0 15px 35px rgba(0,0,0,0.3); text-align:center; position:relative; }
  h2 { color:#333; margin-bottom:20px; }
  label { font-weight:500; color:#555; margin-top:10px; display:block; text-align:left; }
  input, select, button { width:100%; padding:12px; margin-top:5px; margin-bottom:15px; border-radius:8px; border:1px solid #ccc; font-size:16px; }
  input[readonly]{background-color:#f0f0f0;}
  button { border:none; border-radius:10px; background:#6C63FF; color:white; font-size:18px; font-weight:500; cursor:pointer; transition:0.3s; margin-top:5px; }
  button:hover{background:#5750d3;}
  .resultado{margin-top:20px; padding:15px; background:#f4f4f4; border-radius:10px; font-weight:500; white-space:pre-line; color:#333; opacity:0; transition:0.5s;}
  .resultado.show{opacity:1;}
  .loading{margin-top:15px; font-style:italic; color:#555;}
  .truck{position:absolute; top:-60px; left:-100px; width:50px; transition:left 1s linear;}
  #pixCodeContainer{margin-top:15px; padding:10px; background:#eee; border-radius:8px; word-break:break-all; display:none; flex-direction:column; align-items:center;}
  #pixCodeContainer button{margin-top:10px; width:auto; padding:5px 10px; font-size:14px;}
  #copyMsg{margin-top:10px; color:green; font-weight:500; display:none;}
</style>
</head>
<body>
<div class="container">
  <img src="https://cdn-icons-png.flaticon.com/512/1995/1995574.png" alt="Caminh√£o" class="truck" id="truckIcon">
  <h2>Calcular Frete</h2>

  <label>CEP de Origem:</label>
  <input type="text" id="cepOrigem" value="04123020" readonly />

  <label>CEP de Destino:</label>
  <input type="text" id="cepDestino" placeholder="Ex: 20010-000" />

  <label>Numero da residencia:</label>
  <input type="number" id="peso" placeholder="Ex: 10" />

  <label>Tipo de Frete:</label>
  <select id="tipoFrete">
    <option value="economico">Econ√¥mico</option>
    <option value="expresso">Expresso</option>
  </select>

  <button onclick="calcularFrete()">Calcular Frete</button>

  <div class="loading" id="loading" style="display:none;">Calculando frete...</div>

  <div class="resultado" id="resultado"></div>
  
  <div id="pixCodeContainer">
    <span id="pixCode"></span>
    <button onclick="copiarPIX()">Copiar PIX</button>
    <div id="copyMsg">Chave PIX copiada com sucesso!</div>
  </div>
</div>

<script>
const chavePIX = "9af00e4a-761d-4cde-842c-26a72b4d988c"; // sua chave PIX
let pixPayload = "";

// anima√ß√£o do caminh√£o
function animarCaminhao(){
  const truck = document.getElementById('truckIcon');
  truck.style.left='400px';
  setTimeout(()=>{truck.style.left='-100px';},1200);
}

// copiar PIX
function copiarPIX(){
  navigator.clipboard.writeText(pixPayload).then(()=>{
    document.getElementById('copyMsg').style.display="block";
  }).catch(()=>alert("Erro ao copiar a chave PIX."));
}

// busca CEP via ViaCEP
async function buscarEndereco(cep){
  try{
    const response = await fetch(`https://viacep.com.br/ws/${cep}/json/`);
    const data = await response.json();
    if(data.erro) return null;
    return data;
  }catch{
    return null;
  }
}

// mostrar PIX ao clicar
function mostrarPIX(){
    pixPayload = chavePIX;
    document.getElementById('pixCode').innerText = pixPayload;
    document.getElementById('pixCodeContainer').style.display="flex";
    document.getElementById('btnPagarFrete').style.display = "none"; // esconde o bot√£o
}

// calcula frete e mostra resultado
async function calcularFrete(){
  const cepOrigem=document.getElementById('cepOrigem').value;
  const cepDestino=document.getElementById('cepDestino').value;
  const peso=parseFloat(document.getElementById('peso').value);
  const tipo=document.getElementById('tipoFrete').value;

  if(!cepDestino || isNaN(peso) || peso<=0){ 
    alert("Preencha todos os campos corretamente!"); 
    return; 
  }

  animarCaminhao();
  document.getElementById('loading').style.display='block';
  document.getElementById('resultado').classList.remove('show');
  document.getElementById('pixCodeContainer').style.display='none';
  document.getElementById('copyMsg').style.display='none';

  setTimeout(async ()=>{
    const enderecoOrigem = await buscarEndereco(cepOrigem);
    const enderecoDestino = await buscarEndereco(cepDestino);
    document.getElementById('loading').style.display='none';

    if(!enderecoOrigem || !enderecoDestino){ 
      alert("CEP inv√°lido!"); 
      return; 
    }

    const valorFrete = tipo==='expresso'?89.90:59.90;

    const textoResultado = 
      `üìç Origem: ${enderecoOrigem.logradouro}, ${enderecoOrigem.bairro} - ${enderecoOrigem.localidade}/${enderecoOrigem.uf}\n`+
      `üìç Destino: ${enderecoDestino.logradouro}, ${enderecoDestino.bairro} - ${enderecoDestino.localidade}/${enderecoDestino.uf}\n`+
      `üí∞ Tipo de Frete: ${tipo.charAt(0).toUpperCase()+tipo.slice(1)}\n`+
      `üíµ Valor do Frete: R$ ${valorFrete.toFixed(2)}`;

    const resultadoDiv=document.getElementById('resultado');
    resultadoDiv.innerText=textoResultado;
    resultadoDiv.classList.add('show');

    // bot√£o "Pagar Frete"
    let btnPagar = document.getElementById('btnPagarFrete');
    if(!btnPagar){
        btnPagar = document.createElement('button');
        btnPagar.id = 'btnPagarFrete';
        btnPagar.innerText = "üí≥ Pagar Frete";
        btnPagar.style.marginTop = "10px";
        btnPagar.onclick = mostrarPIX;
        document.querySelector('.container').appendChild(btnPagar);
    }else{
        btnPagar.style.display = "block";
    }

  },1200);
}
</script>
</body>
</html>
